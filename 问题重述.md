







模型假设

1. 列车工况间可以自由转化，即允许列车在牵引状态下直接进入制动状态
2. 由于没有给定列车长度，我们将列车当作单质点进行计算

问题重述

问题一

在列车在水平轨道上运行的情况下，假设列车所受的阻力满足Davis阻力方程$f=x_1+x_2v+x_3v^2$，要求我们求解列车最短运行时间等情况下列车运行过程的速度-距离曲线，牵引制动力-距离曲线，时间-距离曲线与能量消耗-距离曲线共6组曲线。

我们设列车行驶距离为$S(S\le 5144.7m)$，运行速度的上限为$v_{max}$，列车质量为$m$，列车最大牵引力为$F_{Q}$，机械制动部分最大制动力为$F_Z$。我们先考虑让列车运行时间最短情况下。分析可知，需让列车在最大速率$v_{max}$情况下运行时间最长，即让列车在加速和减速阶段运行时间最短，我们画出示意图如下：

![image-20230512195900027](C:\Users\yuhangmeng\AppData\Roaming\Typora\typora-user-images\image-20230512195900027.png)

其中，$t_0$表示列车从静止开始加速到最大加速度的时刻，$t_1$为列车开始减速的时刻，$T$为列车到达站点B的时刻。我们将列车运行分为三个阶段：加速阶段，匀速行驶阶段和减速阶段。分别讨论如下：

加速阶段

列车以最大牵引力从静止开始启动，此时$t\in [0,t_0)$，由牛顿第二定律，我们有：
$$
F_Q-f=ma_1
$$

$$
f=x_1+x_2v+x_3v^2
$$

$$
v(t)=v(t-\Delta t)+a_1\Delta t\label{1}
$$

我们再对公式\ref{1}两端积分有：
$$
s(t)=s(t-\Delta t)+v(t)\Delta t
$$
匀速阶段

此阶段列车达到最大速率，此时列车加速度为0，$t\in [t_0,t_1]$由受力平衡有：
$$
v(t)=v_{max}
$$

$$
s(t)=s(t_0)+(t-t_0)v_{max}
$$

减速阶段

在此阶段，列车以最大制动力进入减速阶段，此时$t\in(t_1,T]$，由牛顿第二定律有：
$$
f+F_Z=ma_2
$$

$$
v(t)=v(t-\Delta t)-a_2\Delta t
$$

$$
s(t)=s(t_1)+s(t-\Delta t)-v(t)\Delta t
$$

在上面的分析中，我们就得到了速率关于时间和距离关于时间的两个函数表达式：
$$
v(t)=\left\{\begin{matrix}
 v(t-\Delta t)+a_1\Delta t &t\in[0,t_0) \\
 v_{max} &t\in [t_0,t_1] \\
  v(t-\Delta t)-a_2\Delta t&t\in (t_1,T]
\end{matrix}\right.
$$

$$
s(t)=\left\{\begin{matrix}
 s(t-\Delta t)+v(t)\Delta t &t\in[0,t_0) \\
 s(t_0)+(t-t_0)v_{max} &t\in [t_0,t_1] \\
  s(t_1)+s(t-\Delta t)-v(t)\Delta t&t\in (t_1,T]
\end{matrix}\right.
$$

可以看出上述函数为非线性的微分方程，我们在$t\in[0,t_0)\cup(t_1,T]$时刻对以上函数进行积分有：
$$
v(t)=\left\{\begin{matrix}
 \int_0^t\frac{F_Q-x_1-x_2v(t)-x_3v^2(t)}{m}\mathrm{d}t &t\in[0,t_0) \\
 v_{max} &t\in [t_0,t_1] \\
  v_{max}-\int_{t_1}^{t}\frac{F_Z+x_1+x_2v(t)+x_3v^2(t)}{m}\mathrm{d}t &t\in (t_1,T]
\end{matrix}\right.
$$

$$
s(t)=\left\{\begin{matrix}
 \int_0^tv(t) \mathrm{d}t &t\in[0,t_0) \\
 s(t_0)+(t-t_0)v_{max} &t\in [t_0,t_1] \\
  s(t_1)+\int_{t_1}^tv(t)\mathrm{d}t&t\in (t_1,T]
\end{matrix}\right.
$$

我们设列车总消耗的能量为$E_X$，由于阻力所消耗的能量为$E_f$，列车制动所消耗的能量为$E_Z$，易得：
$$
E_f(t)=f\cdot s(t)
$$

$$
E_Z(t)=F_Z(t)\cdot \max\{s(t)-s(t_1),0\}
$$

则我们由动能定理有：
$$
\frac{1}{2}mv^2-0=E_X-E_f-E_Z
$$
整理得：
$$
E_X(t)=\frac{1}{2}mv^2(t)+E_f(t)+E_Z(t)
$$
可以看出在列车所受阻力满足Davis阻力方程情况下，我们的微分方程$\mathbf{D}{v(t)}=\phi (v(t))$中$v(t)$最高次数为2次，说明该微分方程并非线性的，故我们无法求得解析解。基于此，我们可以利用龙格库塔法求解该非刚性常微分方程组（ODEs）的解析解，这里我们将利用MATLAB自带的ode45函数进行求解。

龙格-库塔法是常用的一种求解常微分方程初值问题的数值方法。它利用迭代的方式逼近精确解，并具有一定的精度和稳定性。

对于一阶常微分方程$y'=f(x,y)$，初始条件为$y(x_0)=y_0$，龙格-库塔法的基本思路是在$x_0$处计算初始值$y_0$，然后在$x_0$处计算斜率$k_1=f(x_0,y_0)$，接着通过四个不同点的加权平均来计算下一个近似解$y_1$：

$$
k_1=f(x_0,y_0) \\
k_2=f(x_0+\frac{h}{2},y_0+\frac{k_1h}{2}) \\
k_3=f(x_0+\frac{h}{2},y_0+\frac{k_2h}{2}) \\
k_4=f(x_0+h,y_0+k_3h) \\
y_1=y_0+\frac{h}{6}(k_1+2k_2+2k_3+k_4)
$$

其中，$h$为步长，可以根据需要调整。

使用龙格-库塔法，可以通过多次迭代来得到一个足够接近精确解的数值解，其精度通常比欧拉法更高。















在上述求解过程中，为了让列车运行时间最短，我们没有考虑列车进入惰性阶段，即列车牵引力和制动力全部降为0，只有运行阻力做功，记$F_D$为惰性阶段列车所受外力，我们有：
$$
F_D=-f
$$

$$
F_D=ma_3
$$

我们在最短时间上增加$T'$，我们就考虑在匀速阶段和减速阶段中间加入惰性阶段，列车运行时间增加变化的$v$-$t$曲线如下图所示：

![image-20230513111110034](C:\Users\yuhangmeng\AppData\Roaming\Typora\typora-user-images\image-20230513111110034.png)

其中，$t_0'$-$t_1'$阶段为惰行阶段。

在增加$T'$时间后的$v’(t)$和$s'(t)$函数重新表达为：
$$
v'(t)=\left\{\begin{matrix}
 \int_0^t\frac{F_Q-x_1-x_2v(t)-x_3v^2(t)}{m}\mathrm{d}t &t\in[0,t_0) \\
 v_{max} &t\in [t_0,t'_0) \\
v(max)-\int_{t'_0}^{t}\frac{x_1+x_2v(t)+x_3v^2(t)}{m}\mathrm{d}t&t\in [t'_0,t'_1]\\
  v(t'_1)-\int_{t'_1}^{t}\frac{F_Z+x_1+x_2v(t)+x_3v^2(t)}{m}\mathrm{d}t &t\in (t'_1,T+T']
\end{matrix}\right.
$$

$$
s'(t)=\left\{\begin{matrix}
 \int_0^tv(t) \mathrm{d}t &t\in[0,t_0) \\
 s(t_0)+(t-t_0)v_{max} &t\in [t_0,t'_0) \\
s(t'_0)+\int_{t'_0}^tv(t)\mathrm{d}t&t\in [t'_0,t'_1]\\
  s(t_1)+\int_{t'_1}^tv(t)\mathrm{d}t&t\in (t'_1,T+T']
\end{matrix}\right.
$$

我们需要让时间增加后列车行驶的总距离不变，有：
$$
s(T)=s'(T+T')
$$
我们分别带入$T'=10,20,,50,150,300$，数值计算列车每个时刻对应的距离，速度，牵引制动力以及能量消耗。按照题目要求分别画图如下：



























问题二分析

考虑动态过程，要求设计优化方案得到可行的速度轨迹使得列车能耗降低。参照问题一做出列车以最短运行时间等情况下的速度-距离曲线、牵引制动力-距离曲线、时间-距离曲线和能量消耗-距离曲线。



由于列车运行的不同道路段的最高限速和坡度都不完全相同，我们首先根据附件二中的路况信息可视化各路段的坡度和最大速度限制，再对不同道路段进行离散化处理，结果如图：

![image-20230513141116329](C:\Users\yuhangmeng\AppData\Roaming\Typora\typora-user-images\image-20230513141116329.png)

我们首先假设线路$X$由$n$个不同的离散区间$X_n$组成，满足：
$$
{\textstyle \bigcup\limits_{n}}X_n=X \quad \& \quad {\textstyle \bigcap_\limits{n}}X_n=\emptyset
$$
使得线路中各个区间的优化目标下列车的能耗为$E_X$,则有：
$$
E_X=\min\sum\limits_{i=1}^nE_{X_n}
$$
我们容易得到的约束条件有：
$$
0\le v_{X_n}\le v_{{X_n}_{max}}
$$
列车在坡道中所受到的重力也会阻碍列车前进，有：
$$
F_\theta =mg\sin\theta
$$
所以坡道单位阻力有：
$$
f_\theta=\frac{F_\theta}{mg}=\sin\theta
$$
由于坡道中没有出现大于$30\textperthousand$ 的坡度$\theta$ ，所以我们可以近似认为$\sin\theta=\theta$，则有：
$$
f_\theta=\theta
$$
其中，$f_\theta$为坡度为$\theta$时的坡道阻力。

我们的列车线路区间的部分参数如表所示：

```la
\begin{table}[]
\centering
\caption{各离散线路区间部分参数}
\label{bh}
\begin{tabular}{ccccc}
\hline
\textbf{线路编号} & \textbf{起点位置/m} & \textbf{终点位置/m} & \textbf{坡度/‰} & \textbf{限速/(km/h)} \\ \hline
线路1           & 0               & 198.967         & 0.0617284     & 100                \\
线路2           & 198.967         & 739.018         & 16.2346       & 100                \\
线路3           & 739.018         & 2217.05         & 0.679012      & 100                \\
线路4           & 2217.05         & 2870.8          & -9.81481      & 100                \\
线路5           & 2870.8          & 4178.29         & -3.02469      & 100                \\
线路6           & 4178.29         & 4259.1          & -20.1852      & 100                \\
线路7           & 4259.1          & 4604.66         & -20.1852      & 86                 \\
线路8           & 4604.66         & 4803.63         & 3.02469       & 86                 \\
线路9           & 4803.63         & 4960.1          & 20.3086       & 86                 \\
线路10          & 4960.1          & 5144.7          & 20.3086       & 100                \\ \hline
\end{tabular}
\end{table}
```

根据线路数据，通过离散化理论建立消耗能量-时间的对应关系，利用基于栅格模型的蚁群算法，求解各离散的线路区间速度的最优解，该算法流程图如下：

![image-20230513155539122](C:\Users\yuhangmeng\AppData\Roaming\Typora\typora-user-images\image-20230513155539122.png)

我们就得到了列车最优速度曲线如图：




















![image-20230513095000640](C:\Users\yuhangmeng\AppData\Roaming\Typora\typora-user-images\image-20230513095000640.png)

![image-20230513095012984](C:\Users\yuhangmeng\AppData\Roaming\Typora\typora-user-images\image-20230513095012984.png)





























# 问题重述

## 问题背景

城轨系统的需求侧响应可以在保证乘客满意度的情况下降低牵引能耗成本，可进一步发掘城轨系统减碳节能的潜力。在列车运行过程中，列车与外界会产生各种摩擦，消耗列车牵引的能量。因此，考虑列车与轨道的摩擦、列车受到的空气阻力、列车势能的变化、列车运行过程中的位置限速等因素，在同一段旅途中，使用不同的驾驶策略会产生不同的能量和时间的消耗。因此，需要通过数学建模的方法，探究列车运行过程中能耗消耗规律，为城轨系统减碳节能提供支持。

问题重述

问题一考虑在列车在水平轨道上运行的情况下，假设列车所受的阻力满足 Davis 阻
力方程 f = x1 + x2v + x3v2，要求我们求解列车最短运行时间等情况下列车
运行过程的速度-距离曲线，牵引制动力-距离曲线，时间-距离曲线与能量消
耗-距离曲线共 6 组曲线。

问题二在问题一基础上，考虑动态过程，要求设计优化方案得到可行的速度轨迹使得列车能耗降低。参照问题一做出列车以最短运行时间等情况下的速度-距离曲线、牵
引制动力-距离曲线、时间-距离曲线和能量消耗-距离曲线。

问题三中列车由于前方突发事故的原因，需要在原定基础上延迟60s到达终点，需要设计优化方案在保持列车节能运行下较快地得到调整后的优化速度轨迹，并做出调整后列车运行过程的速度-距离曲线、牵引制动力-距离曲线、时间-距离曲线和能量消耗-距离曲线。

## 问题分析

对问题一的分析

题目给出了列车部分参数，并且假设列车所受的阻力满足Davis阻力方程，我们首先求解列车最短运行时间。分析可知列车在最大速度上行驶时间需要尽量长，也即列车加速阶段和减速阶段运行时间需要尽可能短，这样我们就得出了列车在最短运行时间情况下的三个运行阶段：加速阶段，匀速阶段和减速阶段。我们运用牛顿第二定律对列车进行受力分析，得出列车在各个阶段的速度-时间函数式，容易看出的是列车在加速阶段和减速阶段为非线性微分方程。我们对于非刚性微分方程问题，无法求出其解析解，可以采用微分方程的数值解法，例如龙格库塔法。再分别求解计算出其对应的距离，牵引制动力和耗费的能量并画出最短运行时间的一组曲线。

在最短时间上增加时间$T'$，我们考虑列车存在惰行阶段，即列车在水平方向上只受到阻力的作用。这时候我们有惰性阶段的起始时间和终止时间两个未知量，有运行距离不变和增加的运行时间两个方程，故理论上可以求出未知量的数值解。再求解计算出其变化后对应的距离，牵引制动力和耗费的能量并画出增加时间$T'$后的五组曲线。

对问题二的分析

考虑路况信息，在有限速条件和各路段坡度不同的情况下，要求设计优化方案使得运行过程的能耗降低。由于各路段坡度不同，即使在其他参数都保持一致的情况下列车的能耗也不尽相同，例如在上坡阶段的牵引能耗大于在下坡阶段的牵引能耗。对于复杂的路况信息，我们无法建立微分方程模型对其进行数值求解再去计算其能耗，考虑利用蚁群算法等智能算法对其进行仿真求解。我们首先将路段根据坡度和限速分为不同的路段，将各路段能耗总和最低作为目标函数，再对各路段进行栅格化，利用蚁群算法求解目标函数最小值，这样我们就可以得到使列车运行能耗降低的可行的速度轨迹。

参照问题一考虑列车的最短运行时间，在路段限速由$v_{max}$降低至$v'_{max}$前进入制动阶段使列车恰好在此路段到达最高限速，再以此速度进入匀速行驶阶段最后进行制动阶段。再根据问题一的求解方法得到最短运行时间的一组曲线。

![image-20230514083242294](C:\Users\yuhangmeng\AppData\Roaming\Typora\typora-user-images\image-20230514083242294.png)

在最短时间上增加时间$T'$，我们考虑列车在最后的减速阶段前进入惰行阶段，分别求出其数值解。再求解计算出其变化后对应的距离，牵引制动力和耗费的能量并画出增加时间$T'$后的五组曲线。

对问题三的分析

问题三要求我们再原计划基础上，由于突发事故需要延迟60s到达终点，设计优化方案使得列车保持节能运行情况下得到调整后的优化速度轨迹，并做出列车运行过程的曲线组。我们首先应该根据列车原计划运行时间确定列车可能的速度轨迹，在这里我们考虑改变列车匀速行驶阶段的速度来确定列车的运行速度轨迹使得列车恰好在原计划时间到达站点B。我们在问题一模型的基础上，考虑到要尽可能保持列车节能运行，又由问题二模型可知列车在惰行阶段的能耗最低，又因为减速阶段所运行的距离太短，我们需要考虑提前进入惰行阶段再进入匀速阶段最后再经过减速阶段或是惰行阶段到达站点B。又考虑到需要快速得到调整后的优化速度轨迹，注意到如果将减速阶段分到不同的时间点，它们的积分值即减速阶段运行的距离不会发生改变，我们可以通过数值积分得到这个距离。这样我们就可以让列车提前进入减速阶段，这样我们只需要确定原计划匀速行驶阶段还需行驶的距离再除以原计划匀速行驶阶段剩余时间和延迟的时间就可以得到列车调整后的优化速度轨迹。我们再利用问题一模型得到列车运行过程各参数作出列车运行过程的曲线组。









摘要

随着城市交通电气化进程的快速推进，城市轨道交通的能耗快速增长，城轨系统需求侧响应成为了一种有效的降低牵引能耗成本的手段。本文针对城轨系统的能耗问题，探讨了不同运行策略对能源消耗的影响，通过分析列车运行过程中的路段坡度、速度限速等因素，建立了列车消耗能量优化模型，并结合栅格化蚁群算法进行优化求解。

针对问题一，我们将列车运行阶段进行划分并分别建立距离，速度与时间的微分方程，通过4阶龙格库塔法求其数值解。考虑列车在最短时间上增加运行时间的运行速度轨迹，并画出分别增加$10,20,50,150,300s$的速度-距离曲线、牵引制动力-距离曲线、时间-距离曲线与能量消耗-距离曲线。

针对问题二，我们将路段进行划分并栅格化，利用栅格化蚁群算法对其进行求解，得到使运行过程能耗降低的可行的速度轨迹。在考虑路况信息情况下利用问题一模型求解得到列车最短运行时间的速度轨迹。根据问题一，画出列车以最短时间到达站台 B、在最短运行时间上分别增加 10s、20s、50s、150s、300s 到达站台 B的6组曲线。

针对问题三，我们将列车匀速运行分为两个阶段来降低列车在匀速阶段行驶距离，使得列车能够在原计划基础上延迟60s到达终点，并且对运行方案进行优化，得到优化后的运行速度轨迹并做出优化后列车运行过程的速度-距离曲线、牵引制动力-距离曲线、时间-距离曲线与能量消耗-距离曲线。

列车能耗优化

龙格库塔法

栅格化蚁群算法

